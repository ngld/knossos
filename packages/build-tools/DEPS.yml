vars:
  PROTOC: 3.17.0
  LIBARCHIVE: 3.5.1
  CEF: 90.6.6+g3c44b04+chromium-90.0.4430.93
  MSYS_BUILD: 20210419
  NODEJS: 14.17.0
  BROTLI: 1.0.9
  NINJA: 1.10.2
  GOLANG_CI: 1.40.1

update-checks:
  PROTOC:
    github:
      project: protocolbuffers/protobuf
  LIBARCHIVE:
    github:
      project: libarchive/libarchive
  CEF:
    regex:
      url: https://cef-builds.spotifycdn.com/index.json
      pattern: '"cef_version": "([^"]+)", "channel": "stable",'
  MSYS_BUILD:
    regex:
      url: http://repo.msys2.org/distrib/x86_64/
      pattern: msys2-base-x86_64-([0-9]+)\.tar\.xz
      last: true
  NODEJS:
    regex:
      url: https://nodejs.org/en/
      pattern: ' title="Download ([0-9\.]+) LTS" '
  BROTLI:
    github:
      project: google/brotli
  NINJA:
    github:
      project: ninja-build/ninja
  GOLANG_CI:
    github:
      project: golangci/golangci-lint

deps:
  protoc-linux:
    sha256: aad5cfd2daf9d49f5ec9b14c4e7e7af0392324706c0e5bb3e44ad5e70a7add5e
    if: linux, amd64
    url: https://github.com/protocolbuffers/protobuf/releases/download/v{PROTOC}/protoc-{PROTOC}-linux-x86_64.zip
    strip: 1
    dest: third_party/protoc-dist
    markExec: [protoc]

  protoc-darwin:
    sha256: f51e7d285e9e8fcfe04ac6834d9dab56571e39dbcb01d0437b0eb3ee8a5a76c9
    if: darwin, amd64
    url: https://github.com/protocolbuffers/protobuf/releases/download/v{PROTOC}/protoc-{PROTOC}-osx-x86_64.zip
    strip: 1
    dest: third_party/protoc-dist
    markExec: [protoc]

  protoc-win64:
    sha256: f504bd885835c10d3adc819d8cd442567b7145454f4aaff0caabd341868be90e
    if: windows, amd64
    url: https://github.com/protocolbuffers/protobuf/releases/download/v{PROTOC}/protoc-{PROTOC}-win64.zip
    strip: 1
    dest: third_party/protoc-dist

  cef-linux-full:
    sha256: d069905a3ac8c53a98825b0974984bfaeb819046ddcf8555f9754c69cc416970
    if: linux, amd64
    ifNot: ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_linux64.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-linux:
    sha256: 2f57d7bd969ee2038741ea98c401d21853eb893473d455f2fbaa85123b46d83d
    if: linux, amd64, ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_linux64_minimal.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-darwin-full:
    sha256: 36c66180b095b3012844fbf3e4cf63de1a8646221e071eada91a2506d768a0be
    if: darwin, amd64
    ifNot: ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_macosx64.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-darwin:
    sha256: 695b483503be66d31eab14bf516a22a0c6a0820cfa6087b11a4ebbcb74028e54
    if: darwin, amd64, ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_macosx64_minimal.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-win64-full:
    sha256: 67d69a0185c5916b8f89430af70629853638ca12f0b969db8ffc136567a8f3a8
    if: windows, amd64
    ifNot: ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_windows64.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-win64:
    sha256: 01bd810ddbea80d2a683d647b301b16cd9e022abedb6210e2fdf1ab6fb998b3c
    if: windows, amd64, ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_windows64_minimal.tar.bz2
    strip: 1
    dest: third_party/cef

  libarchive:
    sha256: 9015d109ec00bb9ae1a384b172bf2fc1dff41e2c66e5a9eeddf933af9db37f5a
    url: https://github.com/libarchive/libarchive/releases/download/{LIBARCHIVE}/libarchive-{LIBARCHIVE}.tar.gz
    strip: 1
    dest: third_party/libarchive

  brotli:
    sha256: f9e8d81d0405ba66d181529af42a3354f838c939095ff99930da6aa9cdf6fe46
    url: https://github.com/google/brotli/archive/v{BROTLI}.tar.gz
    strip: 1
    dest: third_party/brotli

  msys2:
    sha256: 1f2cfd8e13b0382096e53ead6fd52d0b656a1f81e1b5d82f44cb4ce8ab68755e
    if: windows, amd64
    ifNot: ci
    url: http://repo.msys2.org/distrib/x86_64/msys2-base-x86_64-{MSYS_BUILD}.sfx.exe
    sfxArgs: "-y -othird_party"
    dest: third_party/msys64

  nodejs-linux:
    sha256: 494b161759a3d19c70e3172d33ce1918dd8df9ad20d29d1652a8387a84e2d308
    if: linux, amd64
    url: https://nodejs.org/dist/v{NODEJS}/node-v{NODEJS}-linux-x64.tar.xz
    strip: 1
    dest: third_party/nodejs

  nodejs-darwin:
    sha256: 7b210652e11d1ee25650c164cf32381895e1dcb3e0ff1d0841d8abc1f47ac73e
    if: darwin, amd64
    url: https://nodejs.org/dist/v{NODEJS}/node-v{NODEJS}-darwin-x64.tar.gz
    strip: 1
    dest: third_party/nodejs

  nodejs-win64:
    sha256: 6582a7259c433e9f667dcc4ed3e5d68bc514caba2eed40e4626c8b4c7e5ecd5c
    if: windows, amd64
    url: https://nodejs.org/dist/v{NODEJS}/node-v{NODEJS}-win-x64.zip
    strip: 1
    dest: third_party/nodejs

  ninja-win64:
    sha256: bbde850d247d2737c5764c927d1071cbb1f1957dcabda4a130fa8547c12c695f
    if: windows, amd64
    url: https://github.com/ninja-build/ninja/releases/download/v{NINJA}/ninja-win.zip
    dest: third_party/ninja

  golangci-linux:
    sha256: 7c133b4b39c0a46cf8d67265da651f169079d137ae71aee9b5934e2281bd18d3
    if: linux, amd64
    url: https://github.com/golangci/golangci-lint/releases/download/v{GOLANG_CI}/golangci-lint-{GOLANG_CI}-linux-amd64.tar.gz
    strip: 1
    dest: third_party/golangci

  golangci-darwin:
    sha256: 04715fb08566d7342a51352e36a544f246f632ec6bb7f4d7144d6c9e3a2ada7d
    if: darwin, amd64
    url: https://github.com/golangci/golangci-lint/releases/download/v{GOLANG_CI}/golangci-lint-{GOLANG_CI}-darwin-amd64.tar.gz
    strip: 1
    dest: third_party/golangci

  golangci-win64:
    sha256: 0dd4397b714a4c19a4a72cfd814f42789eeb7ba90dccd65bce47738231c15898
    if: windows, amd64
    url: https://github.com/golangci/golangci-lint/releases/download/v{GOLANG_CI}/golangci-lint-{GOLANG_CI}-windows-amd64.zip
    strip: 1
    dest: third_party/golangci
