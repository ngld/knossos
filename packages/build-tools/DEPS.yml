vars:
  PROTOC: 3.18.0
  LIBARCHIVE: 3.5.2
  CEF: 94.4.5+g0fd0d6f+chromium-94.0.4606.71
  MSYS_BUILD: 20210725
  NODEJS: 14.18.0
  BROTLI: 1.0.9
  NINJA: 1.10.2
  GOLANG_CI: 1.42.1
  INNOEXTRACT: 1.9
  OPENAL_SOFT: 1.21.1

update-checks:
  PROTOC:
    github:
      project: protocolbuffers/protobuf
  LIBARCHIVE:
    github:
      project: libarchive/libarchive
  CEF:
    regex:
      url: https://cef-builds.spotifycdn.com/index.json
      pattern: '"cef_version": "([^"]+)", "channel": "stable",'
  MSYS_BUILD:
    regex:
      url: http://repo.msys2.org/distrib/x86_64/
      pattern: msys2-base-x86_64-([0-9]+)\.tar\.xz
      last: true
  NODEJS:
    regex:
      url: https://nodejs.org/en/
      pattern: ' title="Download ([0-9\.]+) LTS" '
  BROTLI:
    github:
      project: google/brotli
  NINJA:
    github:
      project: ninja-build/ninja
  GOLANG_CI:
    github:
      project: golangci/golangci-lint
  INNOEXTRACT:
    github:
      project: dscharrer/innoextract
  OPENAL_SOFT:
    regex:
      url: https://openal-soft.org/
      pattern: 'The latest release is ([0-9.]+), and is available in source form'

deps:
  protoc-linux:
    sha256: 8b6b0c82f730212801d9cce4653abb1a1f4204555a92e8e2b5f625d61e66f1b4
    if: linux && amd64
    url: https://github.com/protocolbuffers/protobuf/releases/download/v{PROTOC}/protoc-{PROTOC}-linux-x86_64.zip
    strip: 1
    dest: third_party/protoc-dist
    markExec: [protoc]

  protoc-darwin:
    sha256: 18c6b9585a0ceff7be1673271b30497f13c3eb8e6894354066c269d2846337c1
    if: darwin && (amd64 || arm64)
    url: https://github.com/protocolbuffers/protobuf/releases/download/v{PROTOC}/protoc-{PROTOC}-osx-x86_64.zip
    strip: 1
    dest: third_party/protoc-dist
    markExec: [protoc]

  protoc-win64:
    sha256: 222ecf84acdaacf2883b95fd83e14f1b3ffb8598f92ad8f595a90e8fd0a8feb8
    if: windows && amd64
    url: https://github.com/protocolbuffers/protobuf/releases/download/v{PROTOC}/protoc-{PROTOC}-win64.zip
    strip: 1
    dest: third_party/protoc-dist

  cef-linux-full:
    sha256: 143ffc646b8dcded15693df0d7a26441961c80028e38c4070d21e82144c5a0b2
    if: linux && amd64 && !ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_linux64.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-linux:
    sha256: 6d6e6fd673bed4ab4003083a816be22408551899989619efd601153c922bf6b0
    if: linux && amd64 && ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_linux64_minimal.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-darwin-full:
    sha256: 774ae8fc3a637a4a3176f8ee6da48525cc0b934dffc0c5218c53cd91d3889a27
    if: darwin && (amd64 || arm64) && !ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_macosx64.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-darwin-arm64-full:
    sha256: f67881b4cbe695228d244a79ef1d9f31f8d8a618945234d2c17bfbbf97de89ce
    # See the note about cef-darwin-arm64 below
    if: darwin && arm64 # && !ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_macosarm64.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-darwin:
    sha256: 90cb88df0c8225977b8a50ff572ada0fed9b8f552912ceb26593f433735e926b
    if: darwin && amd64 && ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_macosx64_minimal.tar.bz2
    strip: 1
    dest: third_party/cef

# Disabled for now since the download seems to be missing.
#  cef-darwin-arm64:
#    sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
#    if: darwin && arm64 && ci
#    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_macosarm64_minimal.tar.bz2
#    strip: 1
#    dest: third_party/cef

  cef-win64-full:
    sha256: c513d5d743cd72f2980f5d8c5ce057182398a8460be9d051dc0790fa4c7d998a
    if: windows && amd64 && !ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_windows64.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-win64:
    sha256: 02e4433734b878529ffa4835deba9e68f732a520615c1f6600d0da23bf3e6632
    if: windows && amd64 && ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_windows64_minimal.tar.bz2
    strip: 1
    dest: third_party/cef

  libarchive:
    sha256: 5f245bd5176bc5f67428eb0aa497e09979264a153a074d35416521a5b8e86189
    url: https://github.com/libarchive/libarchive/releases/download/v{LIBARCHIVE}/libarchive-{LIBARCHIVE}.tar.gz
    strip: 1
    dest: third_party/libarchive

  brotli:
    sha256: f9e8d81d0405ba66d181529af42a3354f838c939095ff99930da6aa9cdf6fe46
    url: https://github.com/google/brotli/archive/v{BROTLI}.tar.gz
    strip: 1
    dest: third_party/brotli

  msys2:
    sha256: 43c09824def2b626ff187c5b8a0c3e68c1063e7f7053cf20854137dc58f08592
    if: windows && amd64 && !ci
    url: http://repo.msys2.org/distrib/x86_64/msys2-base-x86_64-{MSYS_BUILD}.sfx.exe
    sfxArgs: "-y -othird_party"
    dest: third_party/msys64

  nodejs-linux:
    sha256: 5c0bc18b19fd09ff80beb16772e69cb033ee4992a4ccd35bd884fd8f02e6d1ec
    if: linux && amd64
    url: https://nodejs.org/dist/v{NODEJS}/node-v{NODEJS}-linux-x64.tar.xz
    strip: 1
    dest: third_party/nodejs

  nodejs-darwin:
    sha256: 6b9b4d60bcb4eba95488380be8c4da4af98fce3f4a01c9a76db881cbb736656d
    if: darwin && (amd64 || arm64)
    url: https://nodejs.org/dist/v{NODEJS}/node-v{NODEJS}-darwin-x64.tar.gz
    strip: 1
    dest: third_party/nodejs

  nodejs-win64:
    sha256: 2883e83ac3b1e1cb9a9bf65554043640849b39e86761e7c7ac50b664f42f20ff
    if: windows && amd64
    url: https://nodejs.org/dist/v{NODEJS}/node-v{NODEJS}-win-x64.zip
    strip: 1
    dest: third_party/nodejs

  ninja-win64:
    sha256: bbde850d247d2737c5764c927d1071cbb1f1957dcabda4a130fa8547c12c695f
    if: windows && amd64
    url: https://github.com/ninja-build/ninja/releases/download/v{NINJA}/ninja-win.zip
    dest: third_party/ninja

  golangci-linux:
    sha256: 214b093c15863430c4b66dd39df677dab6e38fc873ded147e331740d50eea51f
    if: linux && amd64
    url: https://github.com/golangci/golangci-lint/releases/download/v{GOLANG_CI}/golangci-lint-{GOLANG_CI}-linux-amd64.tar.gz
    strip: 1
    dest: third_party/golangci

  golangci-darwin:
    sha256: 9c0042e91218dc1dd4eb7b54e29c7331eff081b3ac3f88b0d5df89b976fcd45c
    if: darwin && (amd64 || arm64)
    url: https://github.com/golangci/golangci-lint/releases/download/v{GOLANG_CI}/golangci-lint-{GOLANG_CI}-darwin-amd64.tar.gz
    strip: 1
    dest: third_party/golangci

  golangci-win64:
    sha256: 607d68f0960e3a7b69c73bc0164710dabb4ece06c509afa3584b475194e8d720
    if: windows && amd64
    url: https://github.com/golangci/golangci-lint/releases/download/v{GOLANG_CI}/golangci-lint-{GOLANG_CI}-windows-amd64.zip
    strip: 1
    dest: third_party/golangci

  innoextract:
    sha256: 6344a69fc1ed847d4ed3e272e0da5998948c6b828cb7af39c6321aba6cf88126
    url: https://constexpr.org/innoextract/files/innoextract-{INNOEXTRACT}.tar.gz
    strip: 1
    dest: third_party/innoextract

  openal:
    sha256: c8ad767e9a3230df66756a21cc8ebf218a9d47288f2514014832204e666af5d8
    if: "!windows"
    url: https://openal-soft.org/openal-releases/openal-soft-{OPENAL_SOFT}.tar.bz2
    strip: 1
    dest: third_party/openal

  openal-bin:
    sha256: 2e4b005c4f8057adcf4459d9b239d3fe745a9128079b2a091f899550f2d931b0
    if: windows
    url: https://openal-soft.org/openal-binaries/openal-soft-{OPENAL_SOFT}-bin.zip
    strip: 1
    dest: third_party/openal
