vars:
  PROTOC: 3.15.7
  LIBARCHIVE: 3.5.1
  CEF: 89.0.7+gb5952bd+chromium-89.0.4389.72
  MSYS_BUILD: 20210228
  NODEJS: 14.16.0
  BROTLI: 1.0.9
  NINJA: 1.10.2
  GOLANG_CI: 1.39.0

update-checks:
  PROTOC:
    github:
      project: protocolbuffers/protobuf
  LIBARCHIVE:
    github:
      project: libarchive/libarchive
  CEF:
    regex:
      url: https://cef-builds.spotifycdn.com/index.json
      pattern: '"cef_version": "([^"]+)", "channel": "stable",'
  MSYS_BUILD:
    regex:
      url: http://repo.msys2.org/distrib/x86_64/
      pattern: msys2-base-x86_64-([0-9]+)\.tar\.xz
      last: true
  NODEJS:
    regex:
      url: https://nodejs.org/en/
      pattern: ' title="Download ([0-9\.]+) LTS" '
  BROTLI:
    github:
      project: google/brotli
  NINJA:
    github:
      project: ninja-build/ninja
  GOLANG_CI:
    github:
      project: golangci/golangci-lint

deps:
  protoc-linux:
    sha256: 28b8ca3c0f91441ca80598ced2584e58f8281ebfaf0e6377fea45301eddee94f
    if: linux, amd64
    url: https://github.com/protocolbuffers/protobuf/releases/download/v{PROTOC}/protoc-{PROTOC}-linux-x86_64.zip
    strip: 1
    dest: third_party/protoc-dist
    markExec: [protoc]

  protoc-darwin:
    sha256: 4f568bea2fd0087c9726e43a6610fd726d0fb17a447f40f7e4f5490a63b69b90
    if: darwin, amd64
    url: https://github.com/protocolbuffers/protobuf/releases/download/v{PROTOC}/protoc-{PROTOC}-osx-x86_64.zip
    strip: 1
    dest: third_party/protoc-dist
    markExec: [protoc]

  protoc-win64:
    sha256: d592c46b83f1700dfe9588afdd19ef4eaa0c6b114daeb19ce26e98df5e46c123
    if: windows, amd64
    url: https://github.com/protocolbuffers/protobuf/releases/download/v{PROTOC}/protoc-{PROTOC}-win64.zip
    strip: 1
    dest: third_party/protoc-dist

  cef-linux-full:
    sha256: 8c7546df0a3a133a8fa468ea716794916bb3715c55436649cf5881b250e917f4
    if: linux, amd64
    ifNot: ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_linux64.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-linux:
    sha256: a27eeaae71a3186ea21c8c6101d0f278dab8d7dadfe8aa43da3a3e16a3c0f4e5
    if: linux, amd64, ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_linux64_minimal.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-darwin-full:
    sha256: 34fe0a747b5e2d85f527ff8b347c4c4e2aeaa36de2d260a48d6fcea45f24629a
    if: darwin, amd64
    ifNot: ci
    url: https://cef-builds.spotifycdn.com/cef_binary_90.0.1%2Bg2e4c475%2Bchromium-90.0.4430.30_macosx64_beta.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-darwin:
    sha256: bb9caabc8345784f125f9af8553fcb69acd0c45113db9dd83c24141a22be2356
    if: darwin, amd64, ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_macosx64_minimal.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-win64-full:
    sha256: 84d8682a90ca56668f0e61751982aa99bc14f8c3413780cc3b28d428a2c84a67
    if: windows, amd64
    ifNot: ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_windows64.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-win64:
    sha256: c576fdfa88656cf56d99864bdfbeda9c68bb41590f5592d5d722592ca576e5f2
    if: windows, amd64, ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_windows64_minimal.tar.bz2
    strip: 1
    dest: third_party/cef

  libarchive:
    sha256: 9015d109ec00bb9ae1a384b172bf2fc1dff41e2c66e5a9eeddf933af9db37f5a
    url: https://github.com/libarchive/libarchive/releases/download/{LIBARCHIVE}/libarchive-{LIBARCHIVE}.tar.gz
    strip: 1
    dest: third_party/libarchive

  brotli:
    sha256: f9e8d81d0405ba66d181529af42a3354f838c939095ff99930da6aa9cdf6fe46
    url: https://github.com/google/brotli/archive/v{BROTLI}.tar.gz
    strip: 1
    dest: third_party/brotli

  msys2:
    sha256: 75b047250293df04c0cfebca41f9611156a608f0a08e3f2c190534d04ff0eeee
    if: windows, amd64
    ifNot: ci
    url: http://repo.msys2.org/distrib/x86_64/msys2-base-x86_64-{MSYS_BUILD}.sfx.exe
    sfxArgs: "-y -othird_party"
    dest: third_party/msys64

  nodejs-linux:
    sha256: 2e079cf638766fedd720d30ec8ffef5d6ceada4e8b441fc2a093cb9a865f4087
    if: linux, amd64
    url: https://nodejs.org/dist/v{NODEJS}/node-v{NODEJS}-linux-x64.tar.xz
    strip: 1
    dest: third_party/nodejs

  nodejs-darwin:
    sha256: 14ec767e376d1e2e668f997065926c5c0086ec46516d1d45918af8ae05bd4583
    if: darwin, amd64
    url: https://nodejs.org/dist/v{NODEJS}/node-v{NODEJS}-darwin-x64.tar.gz
    strip: 1
    dest: third_party/nodejs

  nodejs-win64:
    sha256: 716045c2f16ea10ca97bd04cf2e5ef865f9c4d6d677a9bc25e2ea522b594af4f
    if: windows, amd64
    url: https://nodejs.org/dist/v{NODEJS}/node-v{NODEJS}-win-x64.zip
    strip: 1
    dest: third_party/nodejs

  ninja-win64:
    sha256: bbde850d247d2737c5764c927d1071cbb1f1957dcabda4a130fa8547c12c695f
    if: windows, amd64
    url: https://github.com/ninja-build/ninja/releases/download/v{NINJA}/ninja-win.zip
    dest: third_party/ninja

  golangci-linux:
    sha256: 3a73aa7468087caa62673c8adea99b4e4dff846dc72707222db85f8679b40cbf
    if: linux, amd64
    url: https://github.com/golangci/golangci-lint/releases/download/v{GOLANG_CI}/golangci-lint-{GOLANG_CI}-linux-amd64.tar.gz
    strip: 1
    dest: third_party/golangci

  golangci-darwin:
    sha256: 7e9a47ab540aa3e8472fbf8120d28bed3b9d9cf625b955818e8bc69628d7187c
    if: darwin, amd64
    url: https://github.com/golangci/golangci-lint/releases/download/v{GOLANG_CI}/golangci-lint-{GOLANG_CI}-darwin-amd64.tar.gz
    strip: 1
    dest: third_party/golangci

  golangci-win64:
    sha256: 52ec2e13a3cbb47147244dff8cfc35103563deb76e0459133058086fc35fb2c7
    if: windows, amd64
    url: https://github.com/golangci/golangci-lint/releases/download/v{GOLANG_CI}/golangci-lint-{GOLANG_CI}-windows-amd64.zip
    strip: 1
    dest: third_party/golangci
