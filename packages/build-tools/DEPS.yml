vars:
  PROTOC: 3.18.0
  LIBARCHIVE: 3.6.0
  CEF: 99.2.12+g2977b3a+chromium-99.0.4844.74
  MSYS_BUILD: 20220319
  NODEJS: 16.14.2
  BROTLI: 1.0.9
  NINJA: 1.10.2
  GOLANG_CI: 1.45.0
  INNOEXTRACT: 1.9
  OPENAL_SOFT: 1.21.1

update-checks:
  PROTOC:
    github:
      project: protocolbuffers/protobuf
  LIBARCHIVE:
    github:
      project: libarchive/libarchive
  CEF:
    regex:
      url: https://cef-builds.spotifycdn.com/index.json
      pattern: '"cef_version": "([^"]+)", "channel": "stable",'
  MSYS_BUILD:
    regex:
      url: http://repo.msys2.org/distrib/x86_64/
      pattern: msys2-base-x86_64-([0-9]+)\.tar\.xz
      last: true
  NODEJS:
    regex:
      url: https://nodejs.org/en/
      pattern: ' title="Download ([0-9\.]+) LTS" '
  BROTLI:
    github:
      project: google/brotli
  NINJA:
    github:
      project: ninja-build/ninja
  GOLANG_CI:
    github:
      project: golangci/golangci-lint
  INNOEXTRACT:
    github:
      project: dscharrer/innoextract
  OPENAL_SOFT:
    regex:
      url: https://openal-soft.org/
      pattern: 'The latest release is ([0-9.]+), and is available in source form'

deps:
  protoc-linux:
    sha256: 8b6b0c82f730212801d9cce4653abb1a1f4204555a92e8e2b5f625d61e66f1b4
    if: linux && amd64
    url: https://github.com/protocolbuffers/protobuf/releases/download/v{PROTOC}/protoc-{PROTOC}-linux-x86_64.zip
    strip: 1
    dest: third_party/protoc-dist
    markExec: [protoc]

  protoc-darwin:
    sha256: 18c6b9585a0ceff7be1673271b30497f13c3eb8e6894354066c269d2846337c1
    if: darwin && (amd64 || arm64)
    url: https://github.com/protocolbuffers/protobuf/releases/download/v{PROTOC}/protoc-{PROTOC}-osx-x86_64.zip
    strip: 1
    dest: third_party/protoc-dist
    markExec: [protoc]

  protoc-win64:
    sha256: 222ecf84acdaacf2883b95fd83e14f1b3ffb8598f92ad8f595a90e8fd0a8feb8
    if: windows && amd64
    url: https://github.com/protocolbuffers/protobuf/releases/download/v{PROTOC}/protoc-{PROTOC}-win64.zip
    strip: 1
    dest: third_party/protoc-dist

  cef-linux-full:
    sha256: 3b05238ba0a5624821fbcc06e91dc025f09cd8328d9dfe9163e7f6a898467c17
    if: linux && amd64 && !ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_linux64.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-linux:
    sha256: 72ce99834d1f9195ba598bc58f21278c04319276ae1ba2706e10b4265331bc6a
    if: linux && amd64 && ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_linux64_minimal.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-darwin-full:
    sha256: 1bd612830af5f166473ba2806cd5f2813794ea090a695354bbc0be6c2fa3a1cc
    if: darwin && amd64 && !ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_macosx64.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-darwin-arm64-full:
    sha256: 74fca89e12fb5bb776c21bcb394fa312e1edbaec31a299ec80ee49a13c465f80
    # See the note about cef-darwin-arm64 below
    if: darwin && arm64 # && !ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_macosarm64.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-darwin:
    sha256: 90f803f7539527f11e6cea69f0d651b6dc52036a822791cdead6427f38885e07
    if: darwin && amd64 && ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_macosx64_minimal.tar.bz2
    strip: 1
    dest: third_party/cef

# Disabled for now since the download seems to be missing.
#  cef-darwin-arm64:
#    sha256: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
#    if: darwin && arm64 && ci
#    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_macosarm64_minimal.tar.bz2
#    strip: 1
#    dest: third_party/cef

  cef-win64-full:
    sha256: 441a80c3040292963db78c0c06d418ad1ae2c60918eceedb0138c9b7e7ef68b8
    if: windows && amd64 && !ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_windows64.tar.bz2
    strip: 1
    dest: third_party/cef

  cef-win64:
    sha256: d5620e55ba2ac946e7924a447fe77fbbd1af12aaeb4ba8a6710073d5f007ec81
    if: windows && amd64 && ci
    url: https://cef-builds.spotifycdn.com/cef_binary_{CEF}_windows64_minimal.tar.bz2
    strip: 1
    dest: third_party/cef

  libarchive:
    sha256: a36613695ffa2905fdedc997b6df04a3006ccfd71d747a339b78aa8412c3d852
    url: https://github.com/libarchive/libarchive/releases/download/v{LIBARCHIVE}/libarchive-{LIBARCHIVE}.tar.gz
    strip: 1
    dest: third_party/libarchive

  brotli:
    sha256: f9e8d81d0405ba66d181529af42a3354f838c939095ff99930da6aa9cdf6fe46
    url: https://github.com/google/brotli/archive/v{BROTLI}.tar.gz
    strip: 1
    dest: third_party/brotli

  msys2:
    sha256: 0548cc4c1f667ba8ab22760e039d2c8a088b419b432c9597eb8adf8235c13fab
    if: windows && amd64 && !ci
    url: http://repo.msys2.org/distrib/x86_64/msys2-base-x86_64-{MSYS_BUILD}.sfx.exe
    sfxArgs: "-y -othird_party"
    dest: third_party/msys64

  nodejs-linux:
    sha256: e40c6f81bfd078976d85296b5e657be19e06862497741ad82902d0704b34bb1b
    if: linux && amd64
    url: https://nodejs.org/dist/v{NODEJS}/node-v{NODEJS}-linux-x64.tar.xz
    strip: 1
    dest: third_party/nodejs

  nodejs-darwin:
    sha256: d3076ca7fcc7269c8ff9b03fe7d1c277d913a7e84a46a14eff4af7791ff9d055
    if: darwin && (amd64 || arm64)
    url: https://nodejs.org/dist/v{NODEJS}/node-v{NODEJS}-darwin-x64.tar.gz
    strip: 1
    dest: third_party/nodejs

  nodejs-win64:
    sha256: 4731da4fbb2015d414e871fa9118cabb643bdb6dbdc8a69a3ed563266ac93229
    if: windows && amd64
    url: https://nodejs.org/dist/v{NODEJS}/node-v{NODEJS}-win-x64.zip
    strip: 1
    dest: third_party/nodejs

  ninja-win64:
    sha256: bbde850d247d2737c5764c927d1071cbb1f1957dcabda4a130fa8547c12c695f
    if: windows && amd64
    url: https://github.com/ninja-build/ninja/releases/download/v{NINJA}/ninja-win.zip
    dest: third_party/ninja

  golangci-linux:
    sha256: ca06a2b170f41a9e1e34d40ca88b15b8fed2d7e37310f0c08b7fc244c34292a9
    if: linux && amd64
    url: https://github.com/golangci/golangci-lint/releases/download/v{GOLANG_CI}/golangci-lint-{GOLANG_CI}-linux-amd64.tar.gz
    strip: 1
    dest: third_party/golangci

  golangci-darwin:
    sha256: f53826957a96a3312f5e932299024a1274b31c8b70d54510803222fb5d9f7af8
    if: darwin && (amd64 || arm64)
    url: https://github.com/golangci/golangci-lint/releases/download/v{GOLANG_CI}/golangci-lint-{GOLANG_CI}-darwin-amd64.tar.gz
    strip: 1
    dest: third_party/golangci

  golangci-win64:
    sha256: a8176b8ff5133de7da4393965091c429f251ecd74405289a80318f62d8284e47
    if: windows && amd64
    url: https://github.com/golangci/golangci-lint/releases/download/v{GOLANG_CI}/golangci-lint-{GOLANG_CI}-windows-amd64.zip
    strip: 1
    dest: third_party/golangci

  innoextract:
    sha256: 6344a69fc1ed847d4ed3e272e0da5998948c6b828cb7af39c6321aba6cf88126
    url: https://constexpr.org/innoextract/files/innoextract-{INNOEXTRACT}.tar.gz
    strip: 1
    dest: third_party/innoextract

  openal:
    sha256: c8ad767e9a3230df66756a21cc8ebf218a9d47288f2514014832204e666af5d8
    if: "!windows"
    url: https://openal-soft.org/openal-releases/openal-soft-{OPENAL_SOFT}.tar.bz2
    strip: 1
    dest: third_party/openal

  openal-bin:
    sha256: 2e4b005c4f8057adcf4459d9b239d3fe745a9128079b2a091f899550f2d931b0
    if: windows
    url: https://openal-soft.org/openal-binaries/openal-soft-{OPENAL_SOFT}-bin.zip
    strip: 1
    dest: third_party/openal
